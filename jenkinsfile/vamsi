pipeline {
agent any
options {
    buildDiscarder(logRotator(numToKeepStr:'10' , artifactNumToKeepStr: '10'))
    timestamps()
    }
environment {
      inventoryName    = 'Bommasani'
}
  stages {
    stage('CheckOut') {
      steps {
        echo 'Checking out project from Bitbucket....'
        dir("vamsi") {
          git branch: 'master', url: 'https://github.com/vamsi8977/Terraform.git'
        }
      }
    }
stage('TF Version') {
      steps {
        ansiColor('xterm') {
          echo 'Cleaning workspace....'
           terraform -v
          """
        }
      }
    }
stage('TF init') {
      steps {
        ansiColor('xterm') {
          echo 'Cleaning workspace....'
           sh """
          cd ${WORKSPACE}/vamsi/terraform;
          terraform init
          """
        }
      }
    }
stage('TF plan') {
      steps {
        ansiColor('xterm') {
          echo 'Cleaning workspace....'
           sh """
          cd ${WORKSPACE}/vamsi/terraform;
          terraform plan
          """
        }
      }
    }
  }//end stages
  post {
      success {
          echo "The build was success."
      }
      failure {
          echo "The build was failed."
      }
  }
}
